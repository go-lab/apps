(function(){"use strict";var e,t,n,r,o,u,i,c,a;n={powerSupply:null},c=function(){return{restrict:"E",template:'<div class=\'device dcPowerSupply\'>\n  <div class="iconLabel" draggable helper="clone" objectType="meter" objectId="{{powerSupply.getId()}}">\n    <div class=\'deviceIcon\'\n      ng-class="{shortCircuit:powerSupply.getShortCircuit(), commonImage_dcVoltageSourceMeter:!configurationModel.acMode, commonImage_acVoltageSourceMeter:configurationModel.acMode}"\n      Xng-click="togglePowerState()"/>\n    <div class=\'label\'>{{powerSupply.getLabel()}}</div>\n  </div>\n  <span class="display">\n      <input type="text" ng-model="powerValue" number="newNumber" ng-enter="enterKey()" class="displayInput">\n      {{ powerSupply.getUnit() }}\n  </span>\n  <powerControl></powerControl>\n</div>',replace:!0,link:function(e,t,n){var r,o;return r=e.circuitModel.getCircuitSimulatorActionLogger(),e.togglePowerState=function(){return e.powerSupply.setState(!e.powerSupply.getState()),r.logPowerAction(e.powerSupply)},o=function(){return e.powerValue=e.powerSupply.getInternalValue()},e.$watch("powerSupply.getInternalValue()",function(){return o()}),e.newNumber=function(t){return console.log("new number entered: "+t),e.powerSupply.setValue(t),o(),r.logPowerAction(e.powerSupply)},e.enterKey=function(){return e.newNumber(e.powerValue)},e.getDragAndDropTransferObject=function(){return new ut.simulations.electricity.ElectricityLabDataSourceColumnDrop(e.powerSupply.getDataSourceColumn())}}}},window.ut.simulations.electricity.circuitsimulator.directive("powerSupply".toLowerCase(),[c]),r=500,e=50,o=16.666,a=2500,t=300,i=function(e,n){return{restrict:"E",template:'<div class="powerControl">\n  <i class="fa fa-angle-up fa-fw activeButton fontAweSomeButton increasePower"></i>\n  <i class="fa fa-angle-down fa-fw activeButton fontAweSomeButton decreasePower"></i>\n</div>',replace:!0,link:function(n,u,i){var c,l,p,w,s;return c=n.circuitModel.getCircuitSimulatorActionLogger(),w=n.powerSupply,s=function(u,i){var l,p,s,f,g,d,m,S,y,v,b,P;return l=null,p=r,S=0,b=0*i,v=b,f=!1,y=Date.now(),d=0,m=0,s=function(e){if(e.stopPropagation(),!f)return p=r,S=0,b=i*w.getStepValue(),v=b,f=!0,y=Date.now(),d=0,m=Date.now()+t,P(),n.$apply()},g=function(t){var r;if(t.stopPropagation(),r=f,f=!1,e.cancel(l),r)return c.logPowerAction(n.powerSupply)},P=function(){var u,i,s,g,b,h,C,D;if(f&&(D=v,u=p,s=Date.now(),d>0&&(b=s-y,C=s-d,++S,b<a?(u=o+(a-b)/a*(r-o),h=1):(u=o,h=1+(b-a)/o/5),D=C/(p+u)*2*v*h),g=parseFloat(w.getInternalValue()),i=g+D,w.setValue(i),d=s,p=u,l=e(P,p),Date.now()>=m))return c.logPowerAction(n.powerSupply),m=Date.now()+t},u.on("mousedown",function(e){return s(e)}),u.on("mouseup",function(e){return g(e)}),u.on("mouseleave",function(e){return g(e)}),u.on("touchstart",function(e){return s(e)}),u.on("touchmove",function(e){}),u.on("touchend",function(e){return g(e)}),u.on("touchcancel",function(e){return g(e)})},p=u.find(".increasePower"),s(p,1),l=u.find(".decreasePower"),s(l,-1),n.switchPowerOff=function(){return n.powerSupply.setState(!1)},n.switchPowerOn=function(){return n.powerSupply.setState(!0)}}}},window.ut.simulations.electricity.circuitsimulator.directive("powerControl".toLowerCase(),["$timeout","$interval",i]),n={number:""},u=function(){return{restrict:"A",link:function(e,t,n,r){return t.filter_input({regex:"[0-9.-]"}),t.change(function(){var r,o;return r=t.val(),o=parseFloat(r.trim()),e.$apply(n.number+("("+o+")"))})}}},window.ut.simulations.electricity.circuitsimulator.directive("number",[u])}).call(this);
//# sourceMappingURL=power.org.js.map
