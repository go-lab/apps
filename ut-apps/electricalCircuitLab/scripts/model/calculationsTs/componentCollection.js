var __extends=this&&this.__extends||function(n,e){function t(){this.constructor=n}for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)},ut;!function(n){var e;!function(e){var t;!function(e){"use strict";var t=n.commons.tsutils.IdSet,o=function(){function n(n,e,t,o){this._component1=n,this._component2=e,this._isEndLink=o,this._connectionPoints=[],this._id="",this._connectionPoints=t.slice(),this._id=n.getId()+"->"+e.getId()}return n.prototype.getId=function(){return this._id},Object.defineProperty(n.prototype,"component1",{get:function(){return this._component1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"component2",{get:function(){return this._component2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"connectionPoints",{get:function(){return this._connectionPoints.slice()},enumerable:!0,configurable:!0}),n.prototype.isEquivalent=function(n){var e=!this._isEndLink&&!n._isEndLink&&(this.component1===n.component1&&this.component2===n.component2||this.component1===n.component2&&this.component2===n.component1);return e},n.prototype.toString=function(n){void 0===n&&(n="");var e="ComponentLink: "+this.component1.getId()+" -> "+this.component2.getId()+", via";return this.connectionPoints.forEach(function(t,o){e+="\n"+n+" "+o+": "+t.getId()}),e},n}();e.ComponentLink=o;var i=function(){function n(n,e){void 0===e&&(e=null),this._id="",this._components=[],this._componentConnections=null,this._circuitProperties=null,this._realComponents=null,this._components=n.slice(),e&&(this._componentConnections=e.slice(),this.componentConnectionsCheck());var t=n.map(function(n){return n.getId()}).join(", ");this._id="["+t+"]"}return n.createComponentSequence=function(e,t){return new n(e.components.concat(t))},n.prototype.componentConnectionsCheck=function(){if(this._components.length-1!==this._componentConnections.length)throw console.error(this._components),console.error(this._componentConnections),new Error("The number of components ("+this._components.length+") and componentConnections "+("("+this._componentConnections.length+") does not match"))},n.prototype.getId=function(){return this._id},Object.defineProperty(n.prototype,"componentConnections",{get:function(){return this._componentConnections},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"components",{get:function(){return this._components.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"internalComponents",{get:function(){return this._components.slice(this._components.length-1,1).slice(0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"internalComponentSequence",{get:function(){return new n(this._components.slice(1,this._components.length-1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"circuitProperties",{get:function(){return this._circuitProperties},set:function(n){this._circuitProperties=n},enumerable:!0,configurable:!0}),n.prototype.isNone=function(){return!1},n.prototype.collectRealComponents=function(){var n=this;this._realComponents=new t,this._components.forEach(function(t){if(t instanceof c){var o=t;n._realComponents.addAll(o.realComponents)}else if(t instanceof e.ComponentModel){var i=t;n._realComponents.add(i)}})},Object.defineProperty(n.prototype,"realComponents",{get:function(){return this._realComponents||this.collectRealComponents(),this._realComponents},enumerable:!0,configurable:!0}),n.prototype.isSubSequence=function(n){if(this._components.length>n._components.length){var e=this._components.indexOf(n._components[0]);if(e)for(var t=1;t<n._components.length;t++)if(this._components[e+t]!==n._components[t])return!1;return!0}return!1},n.prototype.indexOfSubSequence=function(n){if(this._components.length>n._components.length){var e=this._components.indexOf(n._components[0]);if(e)for(var t=1;t<n._components.length;t++)if(this._components[e+t]!==n._components[t])return-1;return e}return-1},n.prototype.equals=function(n){return this._id===n._id},n.prototype.slice=function(e){if(Math.abs(e)<this._components.length){var t=this._components.slice(e),o=null;return this._componentConnections&&(o=this._componentConnections.slice(e)),new n(t,o)}return null},n.prototype.toString=function(){if(this._componentConnections){var n=this._componentConnections.map(function(n){return n.toString()}).join(", ");return"ComponentSequence(["+this._id+"], ["+n+"])"}return"ComponentSequence(["+this._id+"])"},n.prototype.toNiceString=function(n){var e=this;void 0===n&&(n="");var t=0;this._componentConnections&&(t=this._componentConnections.length);var o="ComponentSequence: with "+this._components.length+" components and "+t+" component connections\n";return this._components.forEach(function(t,i){if(o+=n+" "+i+": ",t instanceof c){var r=t;if(r instanceof s){var p=t;o+="ParallelBatteries ("+p.batteryVoltage+"V)"}else o+="ParallelComponent";o+=": with "+r.parallelComponentSequences.length+" branches\n",r.parallelComponentSequences.forEach(function(e){o+=n+"    "+e.toNiceString(n+"    ")})}else o+=t.getId()+"\n";if(e._componentConnections&&i<e._componentConnections.length){var u=e._componentConnections[i];o+=n+"  <->: "+u.toNiceString(n+"      ")}}),o},n}();e.ComponentSequence=i;var r=function(n){function e(e,t){void 0===t&&(t=null),n.call(this,e,t)}return __extends(e,n),e.prototype.componentConnectionsCheck=function(){},e}(i);e.DeadEndComponentSequence=r;var c=function(){function n(n){this._id="",this._parallelComponentSequences=[],this._circuitProperties=null,this._realComponents=null,this._parallelComponentSequences=n.slice();var e=n.map(function(n){return n.toString()}).join(", ");this._id="["+e+"]"}return Object.defineProperty(n.prototype,"parallelComponentSequences",{get:function(){return this._parallelComponentSequences.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"circuitProperties",{get:function(){return this._circuitProperties},set:function(n){this._circuitProperties=n},enumerable:!0,configurable:!0}),n.prototype.getId=function(){return this._id},n.prototype.getDisplayId=function(){return this._id},n.prototype.getComponentType=function(){return"parallel"},n.prototype.isNone=function(){return!1},n.prototype.collectRealComponents=function(){var n=this;this._realComponents=new t,this._parallelComponentSequences.forEach(function(e){return n._realComponents.addAll(e.realComponents)})},Object.defineProperty(n.prototype,"realComponents",{get:function(){return this._realComponents||this.collectRealComponents(),this._realComponents},enumerable:!0,configurable:!0}),n.prototype.indexOfParallelComponentSequence=function(n){for(var e=0;e<this._parallelComponentSequences.length;e++)if(n.equals(this._parallelComponentSequences[e]))return e;return-1},n.prototype.hasAnEqualParallelComponentSequence=function(n){for(var e=0,t=this._parallelComponentSequences;e<t.length;e++){var o=t[e];if(n.indexOfParallelComponentSequence(o)>=0)return!0}return!1},n.prototype.equals=function(n){if(this._parallelComponentSequences.length!==n._parallelComponentSequences.length)return!1;for(var e=0,t=this._parallelComponentSequences;e<t.length;e++){var o=t[e];if(n.indexOfParallelComponentSequence(o)<0)return!1}return!0},n.prototype.isSubParallelComponent=function(n){if(this._parallelComponentSequences.length!==n._parallelComponentSequences.length)return!1;for(var e=0,t=n._parallelComponentSequences;e<t.length;e++){var o=t[e];if(this.indexOfParallelComponentSequence(o)<0)return!1}return!0},n.prototype.toString=function(){return"ParallelComponent("+this._id+")"},n}();e.ParallelComponent=c;var s=function(n){function e(e,t){n.call(this,e),this._batteryVoltage=t}return __extends(e,n),Object.defineProperty(e.prototype,"batteryVoltage",{get:function(){return this._batteryVoltage},enumerable:!0,configurable:!0}),e}(c);e.ParallelBatteries=s;var p=function(){function n(n,e,t,o,i){this._incomingConnectionPoints=n,this._outgoingConnectionPoints=e,this._internalConnectionPoints=t,this._currentRecipeForConnectionPoints=o,this._deadEndComponentSequences=i,this._debug=!0}return Object.defineProperty(n.prototype,"currentRecipeForConnectionPoints",{get:function(){return this._currentRecipeForConnectionPoints},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"incomingConnectionPoints",{get:function(){return this._incomingConnectionPoints},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outgoingConnectionPoints",{get:function(){return this._outgoingConnectionPoints},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"deadEndComponentSequences",{get:function(){return this._deadEndComponentSequences},enumerable:!0,configurable:!0}),n.prototype.toString=function(){var n=function(n){var e=n.map(function(n){return n.toString()}).join(", ");return n.length+"* ["+e+"]"};return"ComponentConnection(, "+n(this._incomingConnectionPoints)+","+(" "+n(this._outgoingConnectionPoints)+",")+(" "+n(this._internalConnectionPoints)+")")},n.prototype.toNiceString=function(n){void 0===n&&(n="");var e="ComponentConnection\n",t=function(t,o){var i=o.map(function(n){return n.getId()}).join(", ");e+=n+"  "+t+": "+o.length+"\n",e+=n+"    ["+i+"]\n"};return t("Incoming connection points",this._incomingConnectionPoints),t("Outgoing connection points",this._outgoingConnectionPoints),t("Internal connection points",this._internalConnectionPoints),e+=n+"  Dead end component sequences: "+this._deadEndComponentSequences.length+"\n",this._deadEndComponentSequences.forEach(function(t,o){e+=n+"    "+o+": "+t.toNiceString(n+"     ")}),e+=n+"  Current recipes: "+this._currentRecipeForConnectionPoints.length+"\n",this._currentRecipeForConnectionPoints.forEach(function(t,o){e+=n+"    "+o+": "+t.connectionPointId+" -> "+t.currentRecipe+"\n"}),this._currentRecipeForConnectionPoints.length<this._internalConnectionPoints.length&&(e+=n+"    >>>>>> ERROR: nr of missing current recipes: "+(this._internalConnectionPoints.length-this._currentRecipeForConnectionPoints.length+"\n")),e},n}();e.ComponentConnection=p}(t=e.electricity||(e.electricity={}))}(e=n.simulations||(n.simulations={}))}(ut||(ut={}));
//# sourceMappingURL=componentCollection.js.map
