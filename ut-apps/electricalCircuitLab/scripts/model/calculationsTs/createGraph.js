var ut;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function e(e,r,n){this._connectionPoints=e,this._connectionLinks=r,this._components=n,this._debug=t.debugModelCalculations,this._circuitResult=null;var i=this.countPowerSupplies(),o=0,c=0;if(i&&(o=this.countBatteries(),c=this.countOhmMeterSources()),this._circuitResult={state:"not started",error:!0,nrOfPowerSupplies:i,nrOfBatteries:o,componentSequence:null,componentConnectionPointMap:null},0===i)this._circuitResult.state="noPowerSupply",this._circuitResult.error=!1;else if(i>1&&i!==o)c>1?this._circuitResult.state="toManyOhmMeterSources":c>0?this._circuitResult.state="ohmMeterPowerSupplyCombination":this._circuitResult.state="toManyPowerSupplies";else try{this._circuitResult=this.createGraph(),this._circuitResult.nrOfPowerSupplies=i,this._circuitResult.nrOfBatteries=o,this._circuitResult.isOhmMeterCircuit=1===c}catch(t){console.warn("An error occurred during createGraph: "+t),this._circuitResult.state="internalError",this._circuitResult.error=!0}}return Object.defineProperty(e.prototype,"circuitResult",{get:function(){return this._circuitResult},enumerable:!0,configurable:!0}),e.prototype.countPowerSupplies=function(){var t=0;return this._components.forEach(function(e){e.isPowerSupply()&&++t}),t},e.prototype.countBatteries=function(){var t=0;return this._components.forEach(function(e){e.isBattery()&&++t}),t},e.prototype.countOhmMeterSources=function(){var t=0;return this._components.forEach(function(e){e.isOmhMeterSource()&&++t}),t},e.prototype.createGraph=function(){var e=this._connectionLinks.asArray().filter(function(t){return t.component.isPowerSupply()}).filter(function(t){var e=t.fromNode.getDirection(t.component);return t.component.isPowerSupplyMinus(e)});if(0===e.length)throw new Error("Expected to find power start links, but did not find any");for(var r=[],n=null,i=0,o=e;i<o.length;i++){var c=o[i],u=new t.CreateDirectedGraph3(this._components,this._connectionPoints,this._connectionLinks,c);switch(u.result3.state){case"shortCircuit":return this._debug&&console.log("found short circuit, finished"),u.result3;case"circuitFound":return u.createCircuit(),u.result3;case"brokenCircuitFound":r.push(u);break;default:console.error("unexpected result state: "+u.result3.state)}}if(r.length>0){this._debug&&console.log("found broken circuits: "+r.length);for(var s=0,l=r;s<l.length;s++){var a=l[s];try{return a.createBrokenCircuit(),a.result3}catch(t){n=t,console.error(t)}}}if(n)throw n;return{state:"noCircuitFound",error:!0,componentSequence:null,componentConnectionPointMap:null}},e}();t.CreateGraph=e}(e=t.electricity||(t.electricity={}))}(e=t.simulations||(t.simulations={}))}(ut||(ut={}));
//# sourceMappingURL=createGraph.js.map
