(function(){"use strict";var n,o,r,e,t,l,s,i,u,a,c,f,g,h,d,p,v,b,w,m,x,O,y,L,I,P,C,M,S,T,U,j,N,D,F,J,A,R,V,X,G,H,q,_,B,E,k,z,K,Q,W,Y,Z,$,nn,on,rn,en,tn,ln,sn,un,an,cn,fn,gn,hn,dn,pn,vn,bn,wn,mn,xn,On=[].indexOf||function(n){for(var o=0,r=this.length;o<r;o++)if(o in this&&this[o]===n)return o;return-1};window.startupMillis=Date.now(),this.golab=this.golab||{},this.golab.common=this.golab.common||{},h={ie:!1,buildMillis:"",browsser:{}},y=window.head,G="/build/",_="/build_s/",dn=["/commons/","/libs/","/labs/","/tools/","/web/"],F=["/libs/"],X=["/labs/","/tools/","/web/"],E=["/scripts/","/js/","/styles/","/css/","/h/","/libs/"],q=["/commons/","/libs/"],H="/../..",C=!1,y.browser.ie&&y.browser.version<10&&(C=!0),C=!1,f=!1,un=f||!1,mn=!0,b=window.gadgets,on=null!=b,k=!1,B=!1,window.productionStandaloneVersion&&(B=!0),an=on?b.util.getUrlParameters().url:location.href,t="",nn="",vn="",rn=function(){var n,o,r;if(n=function(n){var o,r,e,t,l,s,i;if(r=n.length,l=n.lastIndexOf(_),l>=0)k=!0,B=!0,r=l+_.length-1;else if(t=n.lastIndexOf(G),t>=0)k=!0,r=t+G.length-1;else for(o=0,e=dn.length;o<e;o++)s=dn[o],i=n.lastIndexOf(s),i>=0&&(r=Math.min(i,r));return r<n.length?n.substr(0,r):"http://go-lab.gw.utwente.nl/sources"},o=function(n){var o,r,e;return r=n.indexOf("?"),e=r>=0?n.substring(0,r):n,o=e.lastIndexOf("/"),o>=0?e.substring(0,o):e},r=function(n){var o,r,e;return e=n.lastIndexOf("/"),o=e>0?n.substr(e+1):n,r=o.indexOf("."),r>=0?o.substring(0,r):o},t=n(an),nn=o(an),vn=r(an),f&&console.log("sourceUrl: "+an),f&&console.log("baseUrl: "+t),f&&console.log("rootUrl: "+nn),f&&console.log("toolName: "+vn),f)return console.log("runningInGraasp: "+on+", productionVersion: "+k+", productionStandaloneVersion: "+B+", ")},rn(),s={},L={},bn={},i="",I="",wn="",pn="",m=function(n){var o;return o=nn+n+wn,f&&console.log("getIncludeUrl('"+n+"'): "+o),o},on&&y.browser.ie&&y.browser.version<10&&(A=window.location.port,A&&(A=":"+A),sn=window.location.protocol+"//"+window.location.host+A+"/gadgets/proxy/",f&&console.log("shindigProxy: "+sn),m=function(n){var o,r,e;return e=n.lastIndexOf("/"),o=e>=0?n.substr(e+1):n,r=sn+o+"?container=default&url="+nn+n,f&&console.log("getIncludeUrl('"+n+"'): "+r),r}),ln=function(n){return vn=n},en=function(n){return mn=n},M=function(n,o,r){var e;return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e.open("GET",n,!0),e.onload=function(n){return function(){if(4===e.readyState&&200===e.status)return o(e)}}(this),e.onreadystatechange=function(){if(4===e.readyState&&200!==e.status)return r(e)},e.send()},xn=function(n){var o,r,e,l,u,a,c,g,h;return u=0,h="",c=function(){return n(),z()},o=function(){if(u--,0===u)return pn=wn,i&&pn&&(pn=pn+"&"+i.substring(1)),c()},l=function(n,r,e){var t,l;return l=function(t){var l,s,i;try{s=JSON.parse(t.responseText),i="",f&&(console.log(n),console.log(s)),s.buildMillis&&"_"!==s.buildMillis.charAt(0)?i="?"+r+"t="+s.buildMillis:s.version&&(i="?"+r+"v="+s.version),e(s,i)}catch(o){l=o,console.error("problems parsing the information file ("+n+"):\n"+l)}return o()},t=function(r){return console.warn("information file ("+n+") not found"),o()},++u,M(n+"?"+h,l,t)},mn?(h="u="+Date.now(),a="",k&&!B&&(a=H),r=""+t+a+"/commons/commons.json",e=""+t+a+"/libs/libs.json",g=nn+"/"+vn+".json",l(r,"c",function(n,o){if(s=n,i=o,f)return console.log("commonsPathCacheControlPostFix: "+i)}),l(e,"l",function(n,o){if(L=n,I=o,f)return console.log("libsPathCacheControlPostFix: "+I)}),l(g,"t",function(n,o){if(bn=n,wn=o,f)return console.log("toolPathCacheControlPostFix: "+wn)})):c()},e=function(n){return n.indexOf("/commons/")>=0?n+i:n.indexOf("/libs/")>=0?n+I:n+wn},$={},Z={},U={},T=[],n=function(o,r){var e,t,l,s,i,u;if(r){if(Array.isArray(o)){for(u=[],e=0,l=o.length;e<l;e++)s=o[e],u.push(n(s,r));return u}if("object"==typeof o){i={};for(t in o)s=o[t],i[t]=n(s,r);return i}return r+o}return o},r=function(o,r){var e,t,l;t=n(o,r);for(e in t)l=t[e],$[e]=l;if(f)return console.log("resourcePaths: "+JSON.stringify($))},o=function(o,r){var e,t,l;t=n(o,r);for(e in t)l=t[e],Z[e]=l;if(f)return console.log("resourceModules: "+JSON.stringify(Z))},N=function(n){var o,r,l,s,i,u,a,c,f,g,h,d,p,v;if(k)for(o=0,a=X.length;o<a;o++)if(h=X[o],0===n.indexOf(h))for(r=0,c=E.length;r<c;r++)if(d=E[r],s=n.lastIndexOf(d),s>=0)return g=n.substring(s),e(t+g);for(l=0,f=dn.length;l<f;l++)if(v=dn[l],0===n.indexOf(v))return k&&On.call(F,v)>=0&&(u=n.lastIndexOf(".min.js"),u<0&&(i=n.lastIndexOf(".js"),i>=0&&(n=n.substring(0,i)+".min.js"))),p="",k&&!B&&On.call(q,v)>=0&&(p=H),e(t+p+n);return n},D=function(n){var o,r,e,t;if(Array.isArray(n)){for(t=[],o=0,r=n.length;o<r;o++)e=n[o],t.push(N(e));return t}return N(n)},l=function(n){var o,r,e,t;for(e=[],o=0,r=n.length;o<r;o++)t=n[o],U[t]?f&&console.log("already loaded: "+t):$[t]?e.push($[t]):e.push(t);return e},W=function(n){var o,r,e,t;for(t=[],r=0,e=n.length;r<e;r++)o=n[r],U[o]=!0,t.push(T.push(o));return t},J=function(n){var o,r,e,t,s;if(f&&console.log("orderedLoad("+JSON.stringify(n)+")"),n.length)return t=n[0],r=n.length>1?n.slice(1):[],s=Date.now(),o=function(){var n;return n=Date.now()-s,f&&console.log("loaded: "+t+" in "+n+" ms."),J(r)},t=l(t),t.length?(W(t),e=D(t),f&&console.log("loading: "+JSON.stringify(t)),f&&console.log("real paths: "+JSON.stringify(e)),y.load(e,o)):o()},a=function(n){var o,r,e,t,l,s,i,u,c,g,h,d,p;for(u=[],o=0,t=n.length;o<t;o++){for(p=n[o],i=[],r=0,l=p.length;r<l;r++)if(h=p[r],Z[h])if(d=a(Z[h]),1===d.length)for(c=d[0],e=0,s=c.length;e<s;e++)g=c[e],i.push(g);else u=u.concat(d);else i.push(h);i.length&&u.push(i)}return f&&console.log("loadList: "+JSON.stringify(u)),u},Y=function(n){var o,r,e,t,l,s,i,u,a;for(i={},o=[],r=0,t=n.length;r<t;r++){for(a=n[r],s=[],e=0,l=a.length;e<l;e++)u=a[e],i[u]||(s.push(u),i[u]=!0);s.length&&o.push(s)}return o},c=".css",j=function(n){var o,r,e,t,l,s,i,u,a;for(r=function(n){var o;return o=n.toLowerCase().lastIndexOf(".css"),o===n.length-c.length},s=[],o=0,t=n.length;o<t;o++){for(a=n[o],i=[],e=0,l=a.length;e<l;e++)u=a[e],r(u)?s.push([u]):i.push(u);i.length&&s.push(i)}return s},P=function(n){var o,r,e,t,l,s,i;for(t=16,e=[],o=0,r=n.length;o<r;o++)for(i=n[o],l=0;l<i.length;)s=Math.min(t,i.length-l),e.push(i.slice(l,l+s)),l+=s;return e},u=function(n){var o,r,e,t;for(o=0,r=0,e=n.length;r<e;r++)t=n[r],o+=t.length;return o},V=function(n,o){var r,e,t,l,s,i,u,a;for(console.log(n),a=[],e=r=0,s=Q.length;r<s;e=++r){for(u=Q[e],console.log(" "+(e+1)+": [ ("+u.length+" resources)"),l=0,i=u.length;l<i;l++)t=u[l],console.log("     "+t);a.push(console.log("    ]"))}return a},gn=Date.now(),Q=[],S=!1,hn=function(n){return S&&console.error("there is still a load in progress"),S=!0,gn=Date.now(),T.length=0,xn(function(){var o;return o=a(n),o=Y(o),C&&(o=j(o)),Q=P(o),un&&V("The real resource list:",Q),f&&console.log("Start ordered loading "+u(Q)+" files in "+Q.length+" steps"),J(Q)})},R=function(){var n,o,r,e,t;for(console.log("Loaded "+T.length+" files:"),t=[],r=o=0,e=T.length;o<e;r=++o)n=T[r],t.push(console.log(" "+(r+1)+": "+n));return t},v=function(n){var o,r,e,t,l,s,i;for(l=[],o=0,e=n.length;o<e;o++)for(i=n[o],r=0,t=i.length;r<t;r++)s=i[r],l.push(s);return[l]},fn=function(n){return console.warn("please use orderedLoad(), flatLoad causes problems in FireFox"),xn(function(){var o;return o=a(n),o=Y(o),Q=v(o),C&&(Q=j(Q)),un&&V("The real resource list:",Q),f&&console.log("Start flat loading "+u(Q)+" files in "+Q.length+" steps"),J(Q)})},K=null,tn=function(n){return K=n},z=function(){return y.ready(function(){var n,o,r;return S=!1,r=Date.now()-gn,o=u(Q),n=o-T.length,n&&(console.error("did not load all resources, missed "+n+" resources"),un||V("The real resource list:",Q)),f&&console.log("Loaded "+T.length+" files, in "+r+" ms."),(f||n)&&R(),K()})},p=function(){var n;return n=an.indexOf("?"),n>=0?an.substring(n):""},cn=p(),x=function(n,o){var r,e,t,l,s,i,u;if(e=n.toLowerCase(),l=null,cn&&"?"===cn[0])for(u=cn.substring(1).split("&"),r=0,t=u.length;r<t;r++)s=u[r],i=s.split("="),2===i.length&&i[0].toLowerCase()===e&&(l=i[1]);return null===l&&o&&(l=o),l},w=function(){return navigator.userLanguage?navigator.userLanguage:navigator.language?navigator.language:"en"},d=function(){var n,o;return on?(n=new b.Prefs,n.getLang()):(o=x("lang"),o?o:w())},O=function(n){var o;return o=n.split("-"),o[0]},g=d(),this.golab.common.resourceLoader={addResourcePaths:r,addResourceModules:o,setToolName:ln,setCacheControl:en,orderedLoad:hn,flatLoad:fn,ready:tn,getDesiredLanguage:function(){return g},getBaseUrl:function(){return t},getRootUrl:function(){return nn},getIncludeUrl:m,getUrlParameter:function(){return x.apply(null,arguments)},isProductionVersion:function(){return k},getCommonsInfo:function(){return s},getLibsInfo:function(){return L},getToolInfo:function(){return bn},getToolPathCacheControlPostFix:function(){return wn},getToolCommonsPathCacheControlPostFix:function(){return pn},isRunningInGraasp:function(){return on}}}).call(this);
//# sourceMappingURL=resourceLoader.js.map
