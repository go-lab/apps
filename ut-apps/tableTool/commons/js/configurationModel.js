(function(){"use strict";var t,e,o,i,n,s,a=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function o(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},u={}.hasOwnProperty;if(window.ut=window.ut||{},ut.commons=ut.commons||{},i={en:"",help:""},s=!1,n=!1,golab.common.resourceLoader&&(t=golab.common.resourceLoader.getUrlParameter("author")))switch(t.toLowerCase()){case"true":case"on":n=!0}n&&console.warn("configuration model is forced to author mode!"),e=["disabled","manualStart","autoStart"],o={help:"",useConfigurationHelp:!1,autoLoadLatestResource:!0,singleDocumentMode:!0,showResourceName:!0,showImportExport:!1,showLoadExamples:!1,showLoadConfiguration:!0,showModelJson:!1,autoSave:!0,defaultResourceName:"",loadInitialResource:!0,initialResourceString:null,collaborationStartup:"disabled",specialLanguageTerms:{}},window.ut.commons.ConfigurationModel=function(t){function i(t,e,s){this.getSpecialLanguageTranslation=a(this.getSpecialLanguageTranslation,this);var r,u,l;switch(i.__super__.constructor.call(this,t,"configuration"),this.startupFinished=!1,r=this.getStorageHandler(),r.configureFilters&&r.setForUserFilter(!1),u=t.toolName,l=function(t){return!!(t&&t.target&&t.target.forApplication)&&t.target.forApplication===u},r.setCustomFilter(l),r.getMetadataHandler().getTarget().forApplication=u,this._context=r.getMetadataHandler?r.getMetadataHandler().getContext():window.golab.ils.context.unknown,this._runningInGraasp=!1,this._runningInIls=!1,this._runningInGolabz=!1,this._context){case window.golab.ils.context.graasp:this._runningInGraasp=!0;break;case window.golab.ils.context.ils:this._runningInIls=!0;break;case window.golab.ils.context.preview:this._runningInGolabz=!0}this._toolId=t.toolName,s&&(this._toolId=s),this._helpHtml=o.help,this._useConfigurationHelp=o.useConfigurationHelp,this._autoLoadLatestResource=o.autoLoadLatestResource,this._singleDocumentMode=o.singleDocumentMode,this._showResourceName=o.showResourceName,this._showImportExport=o.showImportExport,this._showLoadExamples=o.showLoadExamples,this._showLoadConfiguration=o.showLoadConfiguration,this._showModelJson=o.showModelJson,this._autoSave=o.autoSave,this._defaultResourceName=o.defaultResourceName,this._loadInitialResource=o.loadInitialResource,this._initialResourceString=o.initialResourceString,this._collaborationStartup=o.collaborationStartup,this._specialLanguageTerms=o.specialLanguageTerms,this._applicationModel=null,this._authoringMode=this._runningInGraasp||n,this._forceShowConfiguration=!1,t.languageHandler.setSpecialTranslationFunction(this.getSpecialLanguageTranslation),this.initHelp(e),Object.defineProperties(this,{context:{get:this.getContext},runningInGolab:{get:this.getRunningInGolab},runningInGolabz:{get:this.getRunningInGolabz},runningInGraasp:{get:this.getRunningInGraasp},runningInIls:{get:this.getRunningInIls},toolId:{get:this.getToolId},helpHtml:{get:this.getHelpHtml,set:this.setHelpHtml},standardHelpHtml:{get:this.getStandardHelpHtml},useConfigurationHelp:{get:this.getUseConfigurationHelp,set:this.setUseConfigurationHelp},autoLoadLatestResource:{get:this.getAutoLoadLatestResource,set:this.setAutoLoadLatestResource},singleDocumentMode:{get:this.getSingleDocumentMode,set:this.setSingleDocumentMode},multiDocumentMode:{get:this.getMultiDocumentMode,set:this.setMultiDocumentMode},showResourceName:{get:this.getShowResourceName,set:this.setShowResourceName},showImportExport:{get:this.getShowImportExport,set:this.setShowImportExport},showLoadExamples:{get:this.getShowLoadExamples,set:this.setShowLoadExamples},showLoadConfiguration:{get:this.getShowLoadConfiguration,set:this.setShowLoadConfiguration},showModelJson:{get:this.getShowModelJson,set:this.setShowModelJson},autoSave:{get:this.getAutoSave,set:this.setAutoSave},defaultResourceName:{get:this.getDefaultResourceName,set:this.setDefaultResourceName},loadInitialResource:{get:this.getLoadInitialResource,set:this.setLoadInitialResource},initialResourceString:{get:this.getInitialResourceString,set:this.setInitialResourceString},collaborationStartup:{get:this.getCollaborationStartup,set:this.setCollaborationStartup},collaborationStartupOptions:{get:this.getCollaborationStartupOptions},applicationModel:{get:this.getApplicationModel,set:this.setApplicationModel},authoringMode:{get:this.getAuthoringMode,set:this.setAuthoringMode}})}return r(i,t),i.prototype.initHelp=function(t){var e,o;return o=null,e="help.helpDialog.content."+this.getToolId(),this.getLanguageHandler().existsMessage(e)&&(o=this.getLanguageHandler().getMessage(e)),o||(t?(o=t,console.warn("could not find help in language file")):console.warn("could not find help in language file and there is no default help given")),this._standardHelpHtml=o,this._helpHtml=o},i.prototype.isChangeTrackingFullyImplemented=function(){return!0},i.prototype.getContext=function(){return this._context},i.prototype.getRunningInGolab=function(){switch(this.context){case window.golab.ils.context.graasp:case window.golab.ils.context.ils:case window.golab.ils.context.preview:return!0;default:return!1}},i.prototype.getRunningInGolabz=function(){return this._runningInGolabz},i.prototype.getRunningInGraasp=function(){return!!n||this._runningInGraasp},i.prototype.getRunningInIls=function(){return this._runningInIls},i.prototype.getToolId=function(){return this._toolId},i.prototype.getStandardHelpHtml=function(){return this._standardHelpHtml},i.prototype.getHelpHtml=function(){return this._helpHtml},i.prototype.setHelpHtml=function(t){if(t!==this._helpHtml)return this._helpHtml=t,this.emitModelChanged()},i.prototype.getUseConfigurationHelp=function(){return this._useConfigurationHelp},i.prototype.setUseConfigurationHelp=function(t){if(t!==this._useConfigurationHelp)return this._useConfigurationHelp=t,this.emitModelChanged()},i.prototype.getAutoLoadLatestResource=function(){return this._autoLoadLatestResource},i.prototype.setAutoLoadLatestResource=function(t){if(t!==this._autoLoadLatestResource)return this._autoLoadLatestResource=t,this.emitModelChanged()},i.prototype.getSingleDocumentMode=function(){return this._singleDocumentMode},i.prototype.setSingleDocumentMode=function(t){if(t!==this._singleDocumentMode)return this._singleDocumentMode=t,this.emitModelChanged()},i.prototype.getMultiDocumentMode=function(){return!this.getSingleDocumentMode()},i.prototype.setMultiDocumentMode=function(t){return this.setSingleDocumentMode(!t)},i.prototype.getShowResourceName=function(){return this._showResourceName},i.prototype.setShowResourceName=function(t){if(t!==this._showResourceName)return this._showResourceName=t,this.emitModelChanged()},i.prototype.getShowImportExport=function(){return this._showImportExport},i.prototype.setShowImportExport=function(t){if(t!==this._showImportExport)return this._showImportExport=t,this.emitModelChanged()},i.prototype.getShowLoadExamples=function(){return this._showLoadExamples},i.prototype.setShowLoadExamples=function(t){if(t!==this._showLoadExamples)return this._showLoadExamples=t,this.emitModelChanged()},i.prototype.getShowLoadConfiguration=function(){return!!this._runningInGraasp||!this._runningInIls&&this._showLoadConfiguration},i.prototype.setShowLoadConfiguration=function(t){if(t!==this._showLoadConfiguration)return this._showLoadConfiguration=t,this.emitModelChanged()},i.prototype.getForceShowLoadConfiguration=function(){return this._forceShowConfiguration},i.prototype.setForceShowLoadConfiguration=function(t){if(t!==this._forceShowConfiguration)return this._forceShowConfiguration=t,this.emitModelChanged()},i.prototype.getShowModelJson=function(){return this._showModelJson},i.prototype.setShowModelJson=function(t){if(t!==this._showModelJson)return this._showModelJson=t,this.emitModelChanged()},i.prototype.getAutoSave=function(){return this._autoSave},i.prototype.setAutoSave=function(t){if(t!==this._autoSave)return this._autoSave=t,this.emitModelChanged()},i.prototype.getDefaultResourceName=function(){return this._defaultResourceName},i.prototype.setDefaultResourceName=function(t){if(t!==this._autoSave)return this._defaultResourceName=t,this.emitModelChanged()},i.prototype.getLoadInitialResource=function(){return this._loadInitialResource},i.prototype.setLoadInitialResource=function(t){if(t!==this._loadInitialResource)return this._loadInitialResource=t,this.emitModelChanged()},i.prototype.getInitialResourceString=function(){return this._initialResourceString},i.prototype.setInitialResourceString=function(t){if(t!==this._initialResourceString)return this._initialResourceString=t,this.emitModelChanged()},i.prototype.updateInitialResourceString=function(){if(this.authoringMode&&this.applicationModel)return this.setInitialResourceString(JSON.stringify(this.applicationModel.getResource()))},i.prototype.getCollaborationStartup=function(){return this._collaborationStartup},i.prototype.setCollaborationStartup=function(t){if(this._collaborationStartup!==t)return this._collaborationStartup=t,this.emitModelChanged()},i.prototype.getSpecialLanguageTermKeys=function(){return Object.keys(this._specialLanguageTerms)},i.prototype.addSpecialLanguageTermKey=function(t){return this._specialLanguageTerms[t]="",this.emitEvent("specialLanguageTermsChanged"),this.emitModelChanged()},i.prototype.removeSpecialLanguageTermKey=function(t){return delete this._specialLanguageTerms[t],this.emitEvent("specialLanguageTermsChanged"),this.emitModelChanged()},i.prototype.changeSpecialLanguageTermKey=function(t,e){return this._specialLanguageTerms[e]=this._specialLanguageTerms[t],delete this._specialLanguageTerms[t],this.emitEvent("specialLanguageTermsChanged"),this.emitModelChanged()},i.prototype.getSpecialLanguageTermValue=function(t){return this._specialLanguageTerms[t]},i.prototype.setSpecialLanguageTermValue=function(t,e){if(this._specialLanguageTerms[t]!==e)return this._specialLanguageTerms[t]=e,this.emitEvent("specialLanguageTermsChanged"),this.emitModelChanged()},i.prototype.getSpecialLanguageTranslation=function(t){return this._specialLanguageTerms[t]?this._specialLanguageTerms[t]:null},i.prototype.getCollaborationStartupOptions=function(){return e},i.prototype.getApplicationModel=function(){return this._applicationModel},i.prototype.setApplicationModel=function(t){if(this._applicationModel=t,t)return t.addListener("modelChanged",function(t){return function(){return t.emitModelChanged()}}(this)),t.addListener("modelLoaded",function(t){return function(){return t.emitModelLoaded()}}(this))},i.prototype.getAuthoringMode=function(){return this._authoringMode&&null!==this._applicationModel},i.prototype.setAuthoringMode=function(t){return this._authoringMode=t},i.prototype.loadDefaultConfiguration=function(){},i.prototype.getJsonProperty=function(t,e,i){return null==i&&(i=o),t&&"undefined"!=typeof t[e]?t[e]:i[e]},i.prototype.loadFromResourceContent=function(t){return this.clearContent(),i.__super__.loadFromResourceContent.call(this,t),t.help&&(this._helpHtml=this.getJsonProperty(t,"help")),this._useConfigurationHelp=this.getJsonProperty(t,"useConfigurationHelp"),this._autoLoadLatestResource=this.getJsonProperty(t,"autoLoadLatestResource"),this._singleDocumentMode=this.getJsonProperty(t,"singleDocumentMode"),this._showResourceName=this.getJsonProperty(t,"showResourceName"),this._showImportExport=this.getJsonProperty(t,"showImportExport"),this._showLoadExamples=this.getJsonProperty(t,"showLoadExamples"),this._showLoadConfiguration=this.getJsonProperty(t,"showLoadConfiguration"),this._showModelJson=this.getJsonProperty(t,"showModelJson"),this._autoSave=this.getJsonProperty(t,"autoSave"),this._defaultResourceName=this.getJsonProperty(t,"defaultResourceName"),this._loadInitialResource=this.getJsonProperty(t,"loadInitialResource"),this._initialResourceString=this.getJsonProperty(t,"initialResourceString"),this._collaborationStartup=this.getJsonProperty(t,"collaborationStartup"),this._specialLanguageTerms=this.getJsonProperty(t,"specialLanguageTerms"),s&&(this._autoSave=!0),this.emitEvent("specialLanguageTermsChanged")},i.prototype.getResourceContent=function(){var t,e;return t=i.__super__.getResourceContent.call(this),this.updateInitialResourceString(),e=this.authoringMode&&this.applicationModel&&!this.applicationModel.isEmpty()?this._initialResourceString:null,t.help=this._helpHtml,t.useConfigurationHelp=this._useConfigurationHelp,t.autoLoadLatestResource=this._autoLoadLatestResource,t.showResourceName=this._showResourceName,t.singleDocumentMode=this._singleDocumentMode,t.showImportExport=this._showImportExport,t.showLoadExamples=this._showLoadExamples,t.showLoadConfiguration=this._showLoadConfiguration,t.showModelJson=this._showModelJson,t.autoSave=this._autoSave,t.defaultResourceName=this._defaultResourceName,t.loadInitialResource=this._loadInitialResource,t.initialResourceString=e,t.collaborationStartup=this._collaborationStartup,t.specialLanguageTerms=this._specialLanguageTerms,t},i}(window.ut.commons.ResourceEventEmitterModel)}).call(this);
//# sourceMappingURL=configurationModel.js.map
