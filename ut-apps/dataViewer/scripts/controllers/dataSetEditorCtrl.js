(function(){"use strict";var e;window.ut=window.ut||{},ut.commons=ut.commons||{},ut.tools=ut.tools||{},ut.tools.conclusions=ut.tools.conclusions||{},e=function(e,o){var t,n,r,u,a,l,d,c,s,i;return t=o.getDataSetActionLogger(),c={},s={},a=0,l=0,e.nothingSelected=!0,e.dataSetEditor={rowToShow:-1},n=function(){return e.noDataSetColumns=0===o.getNrOfDataSourceColumns(),!1},n(),o.addListeners(["addedDataSourceColumn","removedDataSourceColumn","modelLoaded"],n),e.addColumn=function(){var e,n,r,u;return r="_"+(""+Math.random()).substr(3,10),u={imageInformation:{type:"commonImage",value:"unknown.png"},unit:""},e={type:"number",id:r,label:"?"},n=new ut.tools.dataviewer.StoredDataSourceColumn(u,e),o.addDataSourceColumn(n),t.logColumnAdded(n)},e.addRow=function(){if(console.log("add row"),!e.noDataSetColumns)return e.dataSetEditor.rowToShow=o.getNrOfDataRows(),o.addDataRow(),t.logRowAdded()},i=function(){return e.nothingSelected=!a&&!l,e.canMoveSelectedRowsUp=0===a&&l>0&&!s[0],e.canMoveSelectedRowsDown=0===a&&l>0&&!s[o.getNrOfDataRows()-1],e.canSortOnSelectedColumns=1===a&&0===l},d=function(){return c={},s={},a=0,l=0,i()},d(),o.addListener(["modelLoaded","modelCleared"],function(){return d()}),e.resetSelections=d,e.isColumnSelected=function(e){return!!c[e]},e.isRowSelected=function(e){return!!s[e]},e.isCellSelected=function(o,t){return e.isRowSelected(o)||e.isColumnSelected(t)},e.invertRowSelection=function(e){return s[e]?(delete s[e],--l):(s[e]=!0,++l),i()},e.invertColumnSelection=function(e){return c[e]?(delete c[e],--a):(c[e]=!0,++a),i()},u=function(){var e,o;return o=function(){var o;o=[];for(e in s)o.push(parseInt(e));return o}(),o.sort()},r=function(){var e,o;return o=function(){var o;o=[];for(e in c)o.push(parseInt(e));return o}(),o.sort()},e.deleteSelectedRowsAndColumns=function(){var e,n,a,l,c,s,i,m,S,w;if(w=u().reverse(),w.length){for(c=0,i=w.length;c<i;c++)S=w[c],o.removeDataRow(S);t.logRowsRemoved(w)}if(n=r().reverse(),n.length){for(a=o.getDataSourceColumns(),l=n.map(function(e){return a[e]}),s=0,m=n.length;s<m;s++)e=n[s],o.removeDataSourceColumnByIndex(e);t.logColumnsRemoved(l)}return d()},e.moveSelectedRowsUp=function(){var n,r,a,l,d;if(e.canMoveSelectedRowsUp){for(l=u(),n=0,r=l.length;n<r;n++)a=l[n],o.moveDataRowUp(a),d=s[a-1],s[a-1]=!0,d||delete s[a];return t.logMoveRowsUp(l),i()}},e.moveSelectedRowsDown=function(){var n,r,a,l,d;if(e.canMoveSelectedRowsDown){for(l=u().reverse(),n=0,r=l.length;n<r;n++)a=l[n],o.moveDataRowDown(a),d=s[a+1],s[a+1]=!0,d||delete s[a];return t.logMoveRowsDown(l),i()}},e.sortOnSelectedColumns=function(n){var u;if(e.canSortOnSelectedColumns)return u=r(),o.sortData(u[0],n),t.logSortOnColumns(u,n)}},ut.tools.dataviewer.dataTool.controller("dataSetEditorCtrl",["$scope","dataSetModel",e])}).call(this);
//# sourceMappingURL=dataSetEditorCtrl.js.map
