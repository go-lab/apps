(function(){"use strict";var e=function(e,n){return function(){return e.apply(n,arguments)}};window.ut=window.ut||{},window.ut.commons=window.ut.commons||{},window.ut.commons.LeavePageDetector=function(){function n(){this.simulateLeave=e(this.simulateLeave,this),this.leavingPage=e(this.leavingPage,this),this.addHandler=e(this.addHandler,this),this.debug=!0,this.handlers=[],this.leavePageHandled=!1,window.onbeforeunload=function(e){return function(){if(e.debug&&console.log("LeavePageDetector: window.onbeforeunload start"),e.leavingPage(),e.debug)return console.log("LeavePageDetector: window.onbeforeunload end")}}(this),window.onunload=function(e){return function(){if(e.debug&&console.log("LeavePageDetector: window.onunload start"),e.leavingPage(),e.debug)return console.log("LeavePageDetector: window.onunload end")}}(this),head.mobile&&(window.onblur=function(e){return function(){return e.debug&&console.log("LeavePageDetector: window.onblur start"),setTimeout(function(){if(e.leavingPage(!1),e.debug)return console.log("LeavePageDetector: window.onblur end")},500)}}(this)),this.debug&&console.log("LeavePageDetector: setup finished")}return n.prototype.addHandler=function(e){return this.handlers.push(e)},n.prototype.leavingPage=function(e){var n,o,t,a,i,r;if(null==e&&(e=!0),this.debug&&console.log("LeavePageDetector: leavingPage, leavePageHandled: "+a),!a)for(this.debug&&console.log("calling "+this.handlers.length+" handlers"),r=this.handlers,t=0,i=r.length;t<i;t++){o=r[t];try{o()}catch(e){n=e,console.error(n),alert(n)}}a=e},n.prototype.simulateLeave=function(){return this.debug&&console.log("LeavePageDetector: simulating leave page...."),setTimeout(function(e){return function(){return e.leavingPage(!1)}}(this),50)},n}()}).call(this);
//# sourceMappingURL=LeavePageDetector.js.map
