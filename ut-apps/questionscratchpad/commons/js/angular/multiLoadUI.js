(function(){"use strict";var e,o,n,t,s;window.ut=window.ut||{},ut.commons=ut.commons||{},n=!1,o=0,e=250,t='<span>\n  <div class="busyWithResources" ng-show="busyWithResources"></div>\n  <ul class="toolbarPart">\n      <li ng-show="showRefresh">\n          <i class="fa fa-refresh fa-fw activeButton fontAweSomeButton" Xng-class="{disabledButton: !canRefresh()}"\n             ng-click=\'refreshContent()\' title="{{\'multiLoadSave.refresh.tooltip\' | g4i18n}}"></i>\n      </li>\n      <li ng-show="showUndoRedo">\n          <i class="fa fa-undo fa-fw activeButton fontAweSomeButton"  ng-class="{disabledButton: !undoRedoManager.canUndo}"\n             ng-click=\'undo()\' title="{{\'multiLoadSave.undo.tooltip\' | g4i18n}}"></i>\n      </li>\n      <li ng-show="showUndoRedo">\n          <i class="fa fa-rotate-right fa-fw activeButton fontAweSomeButton"  ng-class="{disabledButton: !undoRedoManager.canRedo}"\n             ng-click=\'redo()\' title="{{\'multiLoadSave.redo.tooltip\' | g4i18n}}"></i>\n      </li>\n      <li ng-show="showModelJson">\n          <i class="fa fa-eye fa-fw activeButton fontAweSomeButton"\n             ng-click=\'showModelJsonDialog()\' title="{{\'loadSave.showModelJson\' | g4i18n}}"></i>\n      </li>\n  </ul>\n  <dialogBox id="{{showModelJsonDialogId}}" title="{{showModelJsonDialogTitle}}" resizable="false" width="670">\n    <div class="modelJsonDialog">\n      <textarea ng-model="model.json" class="modelJson"></textarea>\n      <div class="dialogButtonRow">\n        <ul class="toolbar">\n          <li>\n             <i class="fa fa-refresh fa-fw activeButton fontAweSomeButton dialogButton" ng-click=\'updateModelJson()\'\n              title="{{\'loadSave.showModelJsonDialog.refresh\' | g4i18n}}"></i>\n          </li>\n          <li>\n             <i class="fa fa-times fa-fw activeButton fontAweSomeButton dialogButton"\n               ng-click=\'closeShowModelJsonDialog()\' title="{{\'loadSave.showModelJsonDialog.close\' | g4i18n}}"></i>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </dialogBox>\n</span>\n',s=function(s,l,a,i,r,d,u,c,g){return{restrict:"E",template:t,replace:!0,scope:!0,link:function(t,l,a){var r,d,f,m,w,h,v,M,p,R,S,B,b,J,y,D;return t.busyWithResources=!1,w=o++,b="multiShowModelJsonBox"+w,t.showModelJsonDialogId=b,B=a.modelname,"string"!=typeof B||""===B?void console.error("you must define an attribute 'modelName'"):(h=t[B])?!h instanceof window.ut.commons.ResourceEventEmitterModel?void console.error("expected to find a model class object on the scope, named "+B+", which must be an instance of window.ut.commons.ResourceEventEmitterModel"):!h instanceof window.ut.commons.MultiResourceEventEmitterModel?void console.error("expected to find a model class object on the scope, named "+B+", which must be an instance of window.ut.commons.MultiResourceEventEmitterModel"):(v="configuration"===h.getResourceType(),J=null,v||h.isChangeTrackingFullyImplemented()&&(J=new window.ut.commons.UndoRedoManager(h),t.undoRedoManager=J),m="multiLoadSaveUI("+h.getResourceType()+"):",n&&console.log(m+" start: resourceType: "+h.getResourceType()+", modelIsConfiguration: "+v),D=function(){return t.showRefresh=ut.commons.utils.getBooleanAttributeValue(a,"refresh",!i.autoSave),t.showModelJson=ut.commons.utils.getBooleanAttributeValue(a,"modelJson",i.getShowModelJson()),t.showUndoRedo=J&&h.isChangeTrackingFullyImplemented()&&ut.commons.utils.getBooleanAttributeValue(a,"undoRedo",!1),c(ut.commons.utils.gadgetResize)},D(),M=function(){var e;return e=Date.now(),h.loadLatestResource(function(o,l,a){var i,r;return t.busyWithResources=!1,o?u.reportError(s.getMessage("loadSave.failure.load",o),"Failed to load one or more resources",o):(r=Date.now()-e,n&&console.log(m+" refreshContent: loaded "+h.getResources().length+" resources in "+r+" msec."),a.length>0?(i={objectType:"resources",id:a.map(function(e){return e.getId()}),content:a.map(function(e){return e.getResource()})},h.getActionLogger().log(h.getActionLogger().verbs.open,i)):void 0)})},f=function(){if(i.autoSave)return M()},c(function(){return g(f,e)},e),c(function(){return D(),i.addListeners(["modelChanged","modelLoaded","modelCleared"],function(){return D(),!1})},0),p=h.getResourceType(),R=s.getMessage("resources.type.name."+p),r=h.getApplication(),d=s.getMessage("tools.name."+r),y=v?s.getMessage("loadSave.titleConfiguration.unnamed",d):s.getMessage("loadSave.title.unnamed",R),S=s.getMessage("loadSave.notification.saved",R),t.resourceType=p,t.showModelJsonDialogTitle=s.getMessage("loadSave.showModelJsonDialog.dialogTitle",R),t.refreshContent=function(){return n&&console.log(m+" refreshContent"),t.busyWithResources=!0,M()},t.undo=function(){return null!=J?J.undo():void 0},t.redo=function(){return null!=J?J.redo():void 0},t.showModelJsonDialog=function(){return t.updateModelJson(),t.dialogBoxes[b].show()},t.closeShowModelJsonDialog=function(){return t.dialogBoxes[b].close()},t.model={json:""},t.updateModelJson=function(){var e;return e=h.getResource(),t.model.json=JSON.stringify(e,null,"  ")}):void console.error("expected to find a model class object on the scope, named "+B)}}},ut.commons.golabUtils.directive("multiLoad".toLowerCase(),["languageHandler","fileStorage","localStorageService","configurationModel","leavePageDetector","Notification","errorHandler","$timeout","$interval",s])}).call(this);
//# sourceMappingURL=multiLoadUI.js.map
