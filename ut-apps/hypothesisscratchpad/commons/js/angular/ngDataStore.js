(function(){"use strict";var e,t,a,l;window.ut=window.ut||{},ut.commons=ut.commons||{},e=window.angular,a={loadDataFromJson:null},t=function(e){return{restrict:"E",template:'<table width="100%" border="0">\n    <tr>\n        <td width="1%">\n            {{categoryLabel | i_g4i18n}}\n        </td>\n        <td>\n            <select ng-model="selectedCategory"\n                    ng-options="category for category in dataStore.getCategories()">\n            </select>\n        </td>\n        <td rowspan=\'2\' width="1%" valign="middle" align="right">\n          <i class="fa fa-play fa-fw activeButton fontAweSomeButton"\n                  ng-class=\'{disabledButton:disableLoadButton}\'\n                       ng-click=\'loadSeletedResource()\'></i>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            {{dataLabel | i_g4i18n}}\n        </td>\n        <td>\n            <select ng-model="selectedData" ng-options="data.title for data in getDatas()">\n            </select>\n        </td>\n    </tr>\n</table>',replace:!0,link:function(t,a,l){var o,n,r,s,d,c,i,g,u;if(n=ut.commons.utils.getAttributeValue(l,"dataStoreName"),null===n)throw new Error("attribute dataStoreName is not defined");if(t.categoryLabel="Category",l.categorylabel&&(t.categoryLabel=l.categorylabel),t.dataLabel="Data",l.datalabel&&(t.dataLabel=l.datalabel),t.disableLoadButton=!0,u=function(){return t.disableLoadButton=!t.selectedCategory||!t.selectedData},d=n+"_selectedCategory",g=n+"_selectedDataTitle",!t[n])throw new Error("cannot find data store, named '"+n+"' on the scope");return t.exampleStore=t[n],t.selectedCategory=e.get(d),t.selectedData="",o=t.exampleStore.getCategories(),t.selectedCategory&&o.indexOf(t.selectedCategory)<0&&(t.selectedCategory=""),t.selectedCategory||1!==o.length||(t.selectedCategory=o[0]),t.selectedCategory?(i=e.get(g),i&&(c=t.exampleStore.getData(t.selectedCategory,i)),c||(r=t.exampleStore.getDatas(t.selectedCategory),1===r.length&&(c=r[0])),c&&(t.selectedData=c)):t.selectedCategory="",t.getDatas=function(){return t.exampleStore.getDatas(t.selectedCategory)},u(),s=!1,t.$watch("selectedCategory",function(){return e.set(d,t.selectedCategory),s?t.selectedData="":s=!0,u()}),t.loadSeletedResource=function(){if(t.selectedCategory&&t.selectedData)return console.log("load data: category '"+t.selectedCategory+"', data '"+t.selectedData.title+"'"),t.exampleStore.sendLoadEvent(t.selectedData)},t.$watch("selectedData",function(){return e.set(g,t.selectedData.title),u()})}}},ut.commons.golabUtils.directive("datastoreselection",["localStorageService",t]),l=function(e,t){return{restrict:"E",template:'<div>\n  <table width="100%" border="0" class="selectExampleTable">\n      <tr>\n          <td width="1%">\n              {{categoryLabel | i_g4i18n}}\n          </td>\n          <td>\n              <select ng-model="examples.selectedCategory"\n                      ng-options="category for category in exampleStore.getCategories()">\n              </select>\n          </td>\n      </tr>\n      <tr>\n          <td>\n              {{dataLabel | i_g4i18n}}\n          </td>\n          <td>\n              <select ng-model="examples.selectedData" ng-options="data.title for data in getDatas()">\n              </select>\n          </td>\n      </tr>\n  </table>\n  <div class="dialogButtonRow">\n    <ul class="toolbar">\n      <li>\n         <i class="fa fa-play fa-fw activeButton fontAweSomeButton dialogButton"\n          ng-class="{disabledButton: examples.selectedData==\'\'}" ng-click=\'loadSelectedExample()\' title="{{loadTitle}}"></i>\n      </li>\n      <li>\n         <i class="fa fa-times fa-fw activeButton fontAweSomeButton dialogButton"\n           ng-click=\'closeLoadExample()\' title="{{\'loadSave.showModelJsonDialog.close\' | g4i18n}}"></i>\n      </li>\n    </ul>\n  </div>\n</div>',replace:!0,link:function(a,l,o){var n;return n=function(){var t,l,n,r,s,d,c;if(l=ut.commons.utils.getAttributeValue(o,"exampleStoreName"),null===l)throw new Error("attribute exampleStoreName is not defined");if("undefined"==typeof a[l])throw new Error("cannot find example store, named "+l+", on the scope");if(a.exampleStore=a[l],!a.exampleStore instanceof ut.commons.DataStore)throw new Error("example store, named "+l+", is not an instance of ut.commons.DataStore");if(a.categoryLabel=ut.commons.utils.getAttributeValue(o,"categoryLabel","Category"),a.dataLabel=ut.commons.utils.getAttributeValue(o,"categoryLabel","Data"),a.loadTitle=ut.commons.utils.getAttributeValue(o,"loadTitle",""),a.disableLoadButton=!0,c=function(){return a.disableLoadButton=!a.selectedCategory||!a.selectedData},s=l+"_selectedCategory",d=l+"_selectedDataTitle",a.examples={selectedCategory:e.get(s),selectedData:""},a.exampleStore)return t=[],t=a.exampleStore.getCategories(),a.examples.selectedCategory&&t.indexOf(a.examples.selectedCategory)<0&&(a.examples.selectedCategory=""),!a.examples.selectedCategory&&t.length>0&&(a.examples.selectedCategory=t[0]),r=function(){var t,l,o;return a.examples.selectedCategory?(o=e.get(d),o&&(l=a.exampleStore.getData(a.examples.selectedCategory,o)),l||(t=a.exampleStore.getDatas(a.examples.selectedCategory),t.length>0&&(l=t[0])),l?a.examples.selectedData=l:void 0):a.examples.selectedCategory=""},r(),a.getDatas=function(){var e;return null!=(e=a.exampleStore)?e.getDatas(a.examples.selectedCategory):void 0},c(),n=!1,a.$watch("examples.selectedCategory",function(){return e.set(s,a.examples.selectedCategory),n?a.examples.selectedData="":n=!0,r(),c()}),a.loadSelectedExample=function(){if(a.examples.selectedCategory&&a.examples.selectedData&&a.loadExampleResource)return a.closeLoadExample(),a.loadExampleResource(a.examples.selectedData)},a.$watch("examples.selectedData",function(){return e.set(d,a.examples.selectedData.title),c()}),a.closeLoadExample=function(){var e;return e=ut.commons.utils.getAttributeValue(o,"dialogId",""),e?a.dialogBoxes[e].close():console.warn("cannot find attribute dialogId")}},t(function(){return t(n)})}}},ut.commons.golabUtils.directive("loadExample".toLowerCase(),["localStorageService","$timeout",l])}).call(this);
//# sourceMappingURL=ngDataStore.js.map
