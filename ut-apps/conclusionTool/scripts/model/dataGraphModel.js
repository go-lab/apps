(function(){"use strict";var t,e=function(t,e){function o(){this.constructor=t}for(var a in e)n.call(e,a)&&(t[a]=e[a]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty,o=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};window.ut=window.ut||{},ut.commons=ut.commons||{},ut.tools=ut.tools||{},ut.tools.dataviewer=ut.tools.dataviewer||{},window.google=window.google||{},window.google.visualization=window.google.visualization||{},t={imageUrl:"",unit:"",DataSourceColumn:null},ut.tools.dataviewer.DataGraph=function(t){function n(t,e){this.dataSet=e,n.__super__.constructor.call(this,t,"dataGraph"),this.actionLogger=new ut.tools.dataviewer.DataGraphActionLogger(this.actionLogger),this.sendEmitEvents=!0,this.clearDataGraph(!1),this.chartTypes=["ScatterChart","LineChart","AreaChart","BarChart","ColumnChart","Table"],this.chartType=this.chartTypes[0],this.chartOptions={},this.dataSet.addListener("addedDataSourceColumn",function(t){return function(){}}(this)),this.dataSet.addListener("removedDataSourceColumn",function(t){return function(e){var n,o,a,s,i,r;if(n=e.getId(),t.xAxisColumnId&&t.xAxisColumnId===n&&t.setXAxisColumnId(""),t.yAxisColumnIds.length){for(s=[],i=t.yAxisColumnIds,o=0,a=i.length;o<a;o++)r=i[o],r!==n&&s.push(r);if(s.length<t.yAxisColumnIds.length)return t.setYAxisColumnIds(s)}}}(this)),this.dataSet.addListeners(["addedDataRow","addedDataRows"],function(t){return function(){return t.emitModelChanged()}}(this)),this.dataSet.addListeners(["contentCleared","modelLoaded"],function(t){return function(){return t.clearDataGraph()}}(this)),this.dataSet.addListeners(["modelChanged"],function(t){return function(){return t.emitModelChanged()}}(this))}return e(n,t),n.prototype.createNewModel=function(){var t;return t=this.dataSet.createNewModel(),new window.ut.tools.dataviewer.DataGraph(this.environmentHandlers,t)},n.prototype.getDataGraphActionlogger=function(){return this.actionLogger},n.prototype.isEmpty=function(){return this.dataSet.isEmpty()},n.prototype.equals=function(t){var e,n,o;return e=function(t){var e;return e=t.getResource(),delete e.content.dataSet,JSON.stringify(e)},!!this.dataSet.equals(t.dataSet)&&(n=e(this),o=e(t),n===o)},n.prototype.applyLogLoad=function(t,e,o){switch(e){case"dataSet":return this.dataSet.applyLogLoad(t,e,o);default:return n.__super__.applyLogLoad.call(this,t,e,o)}},n.prototype.applyLogSave=function(t,e,o){switch(e){case"dataSet":return this.dataSet.applyLogSave(t,e,o);default:return n.__super__.applyLogSave.call(this,t,e,o)}},n.prototype.applyLogSaveAs=function(t,e,o){switch(e){case"dataSet":return this.dataSet.applyLogSaveAs(t,e,o);default:return n.__super__.applyLogSaveAs.call(this,t,e,o)}},n.prototype.applyLogClear=function(t,e,o){switch(t.object.objectType){case"dataSet":case"data":return this.dataSet.applyLogClear(t,e,o);default:return n.__super__.applyLogClear.call(this,t,e,o)}},n.prototype.applyLogAdd=function(t,e){var n;switch(n=!1,t.object.objectType){case"dataSource":case"data":this.dataSet.applyLogAdd(t,e),n=!0;break;default:console.warn("Unknown object type: "+t.object.objectType)}if(!n)return e(null)},n.prototype.applyLogChange=function(t,e){var n;switch(n=!1,t.object.objectType){case"dataGraph":t.object.content.chartType&&this.setChartType(t.object.content.chartType),t.object.content.xAxis&&this.setXAxisColumnId(t.object.content.xAxis[0]),t.object.content.yAxis&&this.setYAxisColumnIds(t.object.content.yAxis),t.object.content.chartOptions&&this.setChartOptions(t.object.content.chartOptions);break;case"dataSource":case"data":this.dataSet.applyLogChange(t,e),n=!0;break;default:console.warn("Unknown object type: "+t.object.objectType)}if(!n)return e(null)},n.prototype.applyLogRemove=function(t,e){var n;switch(n=!1,t.object.objectType){case"dataSource":case"data":this.dataSet.applyLogRemove(t,e),n=!0;break;default:console.warn("Unknown object type: "+t.object.objectType)}if(!n)return e(null)},n.prototype.getDataSet=function(){return this.dataSet},n.prototype.sendXAxisColumnIdChanged=function(t){if(null==t&&(t=!0),this.emitEvent("xAxisColumnIdChanged",[this.xAxisColumnId]),t)return this.emitModelChanged()},n.prototype.sendYAxisColumnIdsChanged=function(t){if(null==t&&(t=!0),this.emitEvent("yAxisColumnIdsChanged",[this.yAxisColumnIds]),t)return this.emitModelChanged()},n.prototype.sendChartTypeChanged=function(t){if(null==t&&(t=!0),this.emitEvent("chartTypeChanged",[this.chartType]),t)return this.emitModelChanged()},n.prototype.sendChartTypesChanged=function(t){if(null==t&&(t=!0),this.emitEvent("chartTypesChanged",[this.chartTypes]),t)return this.emitModelChanged()},n.prototype.sendChartOptionsChanged=function(t){if(null==t&&(t=!0),this.emitEvent("chartOptionsChanged",[this.chartOptions]),t)return this.emitModelChanged()},n.prototype.clearDataGraph=function(t){if(null==t&&(t=!0),this.xAxisColumnId="",this.yAxisColumnIds=[],t)return this.sendXAxisColumnIdChanged(!1),this.sendYAxisColumnIdsChanged(!1),this.emitModelChanged()},n.prototype.setXAxisColumnId=function(t){if(this.xAxisColumnId!==t)return this.xAxisColumnId=t,this.sendXAxisColumnIdChanged()},n.prototype.setYAxisColumnIds=function(t){return this.yAxisColumnIds=t,this.sendYAxisColumnIdsChanged()},n.prototype.addYAxisColumnId=function(t){if(!(o.call(this.yAxisColumnIds,t)>=0))return this.yAxisColumnIds.push(t),this.sendYAxisColumnIdsChanged()},n.prototype.removeYAxisColumnId=function(t){var e;if(e=this.yAxisColumnIds.indexOf(t),e>=0)return this.yAxisColumnIds.splice(e,1),this.sendYAxisColumnIdsChanged()},n.prototype.getXDataSourceColumn=function(){return this.dataSet.getDataSourceColumn(this.xAxisColumnId)},n.prototype.getXDataSourceColumns=function(){var t;return this.xAxisColumnId&&(t=this.dataSet.getDataSourceColumn(this.xAxisColumnId))?[t]:[]},n.prototype.getYDataSourceColumns=function(){var t,e,n,o,a;for(o=this.yAxisColumnIds,a=[],e=0,n=o.length;e<n;e++)t=o[e],a.push(this.dataSet.getDataSourceColumn(t));return a},n.prototype.setChartType=function(t){if(this.chartType!==t)return this.chartType=t,this.sendChartTypeChanged()},n.prototype.getChartType=function(){return this.chartType},n.prototype.getChartTypes=function(){return this.chartTypes},n.prototype.setChartTypes=function(t){return Array.isArray(t)?(this.chartTypes=t,this.sendChartTypesChanged()):console.log("DataGraph.setChartTypes(), param not a list: "+t)},n.prototype.getChartOptions=function(){return this.chartOptions},n.prototype.getChartOption=function(t){return this.chartOptions[t]},n.prototype.setChartOptions=function(t){return this.chartOptions=t,this.sendChartOptionsChanged()},n.prototype.setChartOption=function(t,e){return this.chartOptions[t]=e,this.sendChartOptionsChanged()},n.prototype.getDataView=function(){var t,e,n,o,a,s,i;for(n=new google.visualization.DataView(this.dataSet.getDataTable()),e=this.xAxisColumnId?[this.xAxisColumnId].concat(this.yAxisColumnIds):this.yAxisColumnIds,s=[],o=0,i=e.length;o<i;o++)t=e[o],t&&(a=this.dataSet.getDataSourceColumnIndex(t),a>=0?s.push(a):console.warn("unknown column id: "+t));return n.setColumns(s),n},n.prototype.getResourceContent=function(){return{dataSet:this.dataSet.getResource(),chartTypes:this.chartTypes,chartType:this.chartType,chartName:this.chartName,chartOptions:this.chartOptions,xAxisColumnId:this.xAxisColumnId,yAxisColumnIds:this.yAxisColumnIds}},n.prototype.loadFromResourceContent=function(t){return this.dataSet.loadFromResource(t.dataSet),this.setChartTypes(t.chartTypes),this.setChartType(t.chartType),this.setChartOptions(t.chartOptions),this.setXAxisColumnId(t.xAxisColumnId),this.setYAxisColumnIds(t.yAxisColumnIds)},n.prototype.emitModelLoaded=function(){return this.sendChartTypesChanged(!1),this.sendChartTypeChanged(!1),this.sendChartOptionsChanged(!1),this.sendXAxisColumnIdChanged(!1),this.sendYAxisColumnIdsChanged(!1),n.__super__.emitModelLoaded.call(this)},n.prototype.clearContent=function(){return this.dataSet.clear(),n.__super__.clearContent.call(this)},n}(window.ut.commons.ResourceEventEmitterModel)}).call(this);
//# sourceMappingURL=dataGraphModel.js.map
