(function(){"use strict";var t,a=function(t,a){function o(){this.constructor=t}for(var n in a)e.call(a,n)&&(t[n]=a[n]);return o.prototype=a.prototype,t.prototype=new o,t.__super__=a.prototype,t},e={}.hasOwnProperty;window.ut=window.ut||{},ut.commons=ut.commons||{},t=window.EventEmitter,ut.commons.DataStore=function(t){function e(){this.datas={},this.ids={}}return a(e,t),e.prototype.addData=function(t,a){var e;return null==(e=this.datas)[t]&&(e[t]=[]),"undefined"==typeof a.title&&a.metadata.target.displayName&&(a.title=a.metadata.target.displayName),"undefined"==typeof a.metadata&&(a.metadata={}),"undefined"==typeof a.metadata.id&&a.id&&(a.metadata.id=a.id,delete a.id),"undefined"==typeof a.metadata.flags&&(a.metadata.flags={}),a.metadata.flags.readOnly=!0,this.datas[t].push(a),this.getDataById(a.metadata.id)&&(console.warn("duplicate id: "+a.metadata.id),console.warn(a)),this.ids[a.metadata.id.toLowerCase()]=a},e.prototype.getDatas=function(t){return this.datas[t]?this.datas[t]:[]},e.prototype.getData=function(t,a){var e,o,n,r;for(r=this.getDatas(t),o=0,n=r.length;o<n;o++)if(e=r[o],e.title===a)return e;return null},e.prototype.getCategories=function(){var t,a,e,o;e=this.datas,o=[];for(a in e)t=e[a],o.push(a);return o},e.prototype.getDataById=function(t){return this.ids[t.toLowerCase()]},e.prototype.resourceExists=function(t){return!!this.ids[t]},e.prototype.sendLoadEvent=function(t){return this.emitEvent("loadData",[t])},e.prototype.getFilteredDataStore=function(t){var a,e,o,n,r,i,d,s,u;for(o=new ut.commons.DataStore,s=this.getCategories(),n=0,i=s.length;n<i;n++)for(a=s[n],u=this.getDatas(a),r=0,d=u.length;r<d;r++)e=u[r],e.metadata&&e.metadata.target&&e.metadata.target.objectType&&e.metadata.target.objectType===t&&o.addData(a,e);return o},e}(t)}).call(this);
//# sourceMappingURL=dataStore.js.map
