{"version":3,"sources":["run.js"],"names":[],"mappings":"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","file":"run.js","sourcesContent":["(function run(ReflectionPoll) {\n    var TOOL_NAME = 'survey';\n    var DOCUMENT_TYPES = ['survey', 'survey_responses'];\n    var FALLBACK_LANGUAGE = 'en';\n    var IMG_PATH = 'app/img';\n\n    var envHandlerOptions = {\n        notificationServer : null,\n        cache: false\n    };\n\n    try {\n        var errorDisplay = ErrorDisplay($('#error'), $('#error .alert .message'));\n        var loadingIndicator = LoadingIndicator($('#loading_indicator'));\n        var handleStartupError = getErrorHandler(errorDisplay, loadingIndicator);\n\n        loadingIndicator.show();\n\n        golab.common.createEnvironmentHandlers(DOCUMENT_TYPES, TOOL_NAME, FALLBACK_LANGUAGE, envHandlerOptions,\n        function(envHandlers) {\n            try {\n                envHandlers.configHandler = ReflectionPoll.ConfigHandler(\n                    TOOL_NAME,\n                    golab.tools.configurationDefinition.ReflectionPoll,\n                    golab.tools.configuration.ReflectionPoll\n                );\n                envHandlers.envHandlerOptions = envHandlerOptions;\n                errorDisplay.setLanguageHandler(envHandlers.languageHandler);\n\n                envHandlers.configHandler.loadConfig(function(error) {\n                    if (error) {\n                        return handleStartupError(error);\n                    }\n                    try {\n                        ReflectionPoll.Application(\n                            envHandlers, loadingIndicator, errorDisplay, {\n                                imgPath: getRoot() + IMG_PATH\n                            }\n                        );\n                        adjustHeightInGraasp();\n                    } catch(err) {\n                        return handleStartupError(err);\n                    }\n                });\n            } catch(error) {\n                handleStartupError(error);\n            }\n        });\n    } catch(error) {\n        console.error(error);\n        document.getElementsByTagName('body')[0].innerHTML =\n            'An error occured while starting the application.';\n    }\n\n    function getErrorHandler(errorDisplay, loadingIndicator) {\n        return function(error) {\n            console.error(error.stack);\n            errorDisplay.show('An error occured while starting the application.');\n            loadingIndicator.hide();\n        };\n    }\n\n    function LoadingIndicator(container) {\n        var $container = $(container);\n        return {\n            show: function() {\n                $container.show();\n            },\n            hide: function() {\n                $container.hide();\n            },\n        };\n    }\n\n    function ErrorDisplay(container, messageElement, languageHandler) {\n        container = $(container);\n        messageElement = messageElement ? $(messageElement) : container;\n\n        var closeBtn = container.find('button');\n        setCloseBtnBehaviour();\n\n        if (languageHandler) {\n            setAriaLabel();\n        }\n\n        return {\n            hide: hide,\n            show: function(message) {\n                if (message) {\n                    messageElement.text(message);\n                }\n                container.show();\n            },\n            setLanguageHandler: function(l) {\n                languageHandler = l;\n                setAriaLabel(languageHandler);\n            }\n        };\n\n        function hide() {\n            container.hide();\n        }\n\n        function setAriaLabel(languageHandler) {\n            closeBtn\n            .attr('aria-label', languageHandler.getMessage('close_alert'));\n        }\n\n        function setCloseBtnBehaviour() {\n            closeBtn.on('click', function() {\n                hide();\n            });\n        }\n    }\n\n    function getRoot() {\n        if (typeof gadgets !== 'undefined' && gadgets.util &&\n            gadgets.util.getUrlParameters) {\n            var root = gadgets.util.getUrlParameters().url;\n            return root.substr(0, root.lastIndexOf('/') + 1);\n        }\n        return '';\n    }\n\n    function adjustHeightInGraasp() {\n        if (typeof gadgets !== 'undefined' && gadgets.window &&\n            gadgets.window.adjustHeight) {\n            gadgets.window.adjustHeight();\n        }\n    }\n})(golab.tools.ReflectionPoll);\n"],"sourceRoot":"/source/"}